KMK_unit_FRA = {
	KMK_unit_FRA_war = {
		icon = GFX_decision_hol_draw_up_staff_plans
		available = {
			hidden_trigger = {
				always = no
			}
		}
		priority = 20
		days_mission_timeout = 100
		fire_only_once = yes
		activation = {
			always = no
		}
		visible = {
		}
		cancel_if_not_visible = yes
		selectable_mission = yes
		cancel_trigger = {
			or = {
				KMK = { controls_state = 16 }
				FRA = { controls_state = 925 }
			}
		}
		cancel_effect = {
			if = {
				limit = { KMK = { controls_state = 16 } }
				if = {
					limit = {
						KMK = {
							has_government = communism
						}
					}
					KMK = {
						white_peace = {
							tag = FRA
							message = KMK_WIN_FRA_c
						}
					}
				}
				else = {
					KMK = {
						white_peace = {
							tag = FRA
							message = KMK_WIN_FRA_n
						}
					}
				}
				FRA = {
					transfer_navy = {
						target = KMK
					}
				}
				KMK = {
					hidden_effect = {
						if = {
							LIB = { is_subject_of = FRA }
							COG = { is_subject_of = FRA }
						}
						country_event = { id = KMK.0030 }
					}
					annex_country = {
						target = FRA
						transfer_troops = no
					}
				}
			}
			else = {
				if = {
					limit = {
						KMK = {
							has_government = communism
						}
					}
					FRA = {
						white_peace = {
							tag = KMK
							message = FRA_WIN_KMK_c
						}
					}
				}
				else = {
					FRA = {
						white_peace = {
							tag = KMK
							message = FRA_WIN_KMK_n
						}
					}
				}
				FRA = {
					annex_country = {
						target = KMK
						transfer_troops = no
					}
				}
			}
		}
	}
	KMK_build_empire = {
		icon = GFX_decision_generic_monarchy
		visible = {
		}
		available = {
			not = {
				country_exists = FRA
			}
			16 = {
				is_owned_by = ROOT
			}
		}
		complete_effect = {
		}
		complete_effect = {
			if = {
				limit = {
					has_government = communism
				}
				set_cosmetic_tag = DEEP_BLACK
			}
			else = {
				set_cosmetic_tag = KMK_FRA_Gensokyo
			}
			add_research_slot = 1
			every_state = {
				limit = {
					is_core_of = FRA
					not = { is_core_of = ROOT }
				}
				add_core_of = ROOT
			}
			set_country_flag = reunit_huanxiangxiang
			add_ideas = KMK_bad_governmet_state
			add_ideas = KMK_bad_econmic_state
			hidden_effect = {
				if = {
					limit = {
						has_country_leader = {
							ruling_only = yes
							character = KMK_Remilia
						}
					}
					news_event = {
						id = KMK_news.0003
						days = 1
					}
				}
			}
		}
		fire_only_once = yes
		ai_will_do = {
			base = 1000
		}
	}
	KMK_WAR_TO_FRA = {
		icon = GFX_decision_generic_prepare_civil_war
		visible = {
			always = no
		}
		available = {
			country_exists = FRA
		}
		complete_effect = {
		}
		cost = 50
		days_remove = 30
		remove_effect = {
			declare_war_on = {
				target = FRA
				type = annex_everything
			}
			every_state = {
				limit = {
					is_core_of = FRA
				}
				add_claim_by = ROOT
			}
		}
		fire_only_once = yes
		ai_will_do = {
			factor = 0
		}
		war_with_on_remove = FRA
		complete_effect = {
			FRA = {
				country_event = {
					id = generic.2010
				}
			}
		}
	}
	KMK_mobilization_fairies = {
		icon = GFX_decision_generic_military
		visible = {
		}
		available = {
			or = {
				has_idea = KMK_Cirno
				has_country_leader = {
					ruling_only = yes
					name = "琪露诺"
				}
			}
		}
		complete_effect = {
		}
		cost = 50
		days_remove = 7
		days_re_enable = 100
		remove_effect = {
			7 = {
				create_unit = {
					division = "name = \"妖精动员部队\" division_template = \"妖精动员部队\" start_experience_factor = 0"
					owner = ROOT
				}
				create_unit = {
					division = "name = \"妖精动员部队\" division_template = \"妖精动员部队\" start_experience_factor = 0"
					owner = ROOT
				}
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
	KMK_dismiss_yaojingbudui = {
		visible = {
		}
		available = {
		}
		complete_effect = {
		}
		cost = 0
		remove_effect = {
			delete_units = {
				division_template = "妖精动员部队"
				disband = no				#will refund equipment and manpower
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	KMK_hejie_huanxiangxiang = {
		icon = GFX_decision_hol_exchange_intelligence_data
		visible = {
		}
		available = {
			not = {
				country_exists = FRA
				country_exists = MRY
				country_exists = HKR
			}
		}
		complete_effect = {
		}
		cost = 0
		fire_only_once = yes
		remove_effect = {
			MRY = {
				every_character = {
					set_nationality = KMK
				}
			}
			HKR = {
				every_character = {
					set_nationality = KMK
				}
			}
			FRA = {
				every_character = {
					set_nationality = KMK
				}
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
}

KMK_unit_HRR = {
	KMK_build_empire_HRR = {
		icon = GFX_decision_generic_monarchy
		visible = {
		}
		available = {
			is_subject = no
			custom_trigger_tooltip = {
				tooltip = ALL_CONTROL_need_state
				NOT = {
					any_state = {
						has_state_flag = HRR
						NOT = {
							is_controlled_by = ROOT
						}
					}
				}
			}
			has_country_leader = {
				ruling_only = yes
				name = "蕾米莉亚·斯卡蕾特"
			}
		}
		complete_effect = {
		}
		remove_effect = {
			set_cosmetic_tag = FRA_Remiria
			every_state = {
				limit = {
					has_state_flag = HRR
				}
				add_core_of = ROOT
			}
			add_country_leader_trait = FRA_Remiria_Sukaretto_traits
		}
		fire_only_once = yes
		ai_will_do = {
			factor = 1
		}
	}
	KMK_transfer_state_HRR = {
		target_trigger = {
			any_country = {
				AND = {
					is_subject_of = ROOT
					FROM = {
						has_state_flag = HRR
						NOT = {
							is_owned_and_controlled_by = ROOT
						}
						is_owned_and_controlled_by = PREV
					}
				}
			}
		}
		state_target = yes
		on_map_mode = map_and_decisions_view
		#name = L_DVL_GER_target_decision_2
		icon = decision_infiltrate_state
		cost = 5
		days_remove = 7
		ai_will_do = {
			factor = 10
		}
		remove_effect = {
			ROOT = {
				transfer_state = FROM
			}
		}
	}
	KMK_declare_war_HRR_country = {
		icon = GFX_decision_generic_prepare_civil_war
		available = {
			has_global_flag = second_weltkrieg_has_started
		}
		target_trigger = {
			FROM = {
				any_controlled_state = {
					has_state_flag = HRR
				}
				NOT = {
					is_in_faction_with = ROOT
				}
			}
			ROOT = {
				is_subject = no
			}
		}
		cost = 10
		days_remove = 30
		ai_will_do = {
			base = 0
			modifier = {
				NOT = {
					any_home_area_neighbor_country = {
						has_war_with = ROOT
					}
				}
				add = 30
			}
		}
		war_with_target_on_remove = yes
		complete_effect = {
			FROM = {
				country_event = {
					id = generic.2010
				}
			}
		}
		remove_effect = {
			declare_war_on = {
				target = FROM
				type = take_state
			}
		}
	}
}

KMK_fix_Financial_crisis = {
	KMK_goodbye_to_Financial_crisis = {
		icon = GFX_decision_congress
		available = {
			hidden_trigger = {
				always = no
			}
		}
		priority = 10
		days_mission_timeout = 900
		fire_only_once = yes
		activation = {
			always = no
		}
		visible = {
		}
		is_good = yes
		cancel_if_not_visible = yes
		timeout_effect = {
			custom_effect_tooltip = KMK_goodbye_to_Financial_crisis_tt
			hidden_effect = {
				remove_dynamic_modifier = {
					modifier = KMK_Financial_crisis
				}
				add_to_variable = {
					exincome_modifier = KMK_Financial_crisis_exincome
				}
				if = {
					limit = {
						has_country_leader = {
							ruling_only = yes
							name = "蕾米莉亚·斯卡蕾特"
						}
					}
					country_event = {
						id = KMK.0018
					}
				}
				if = {
					limit = {
						has_country_leader = {
							ruling_only = yes
							name = "芙兰朵露·斯卡蕾特"
						}
					}
					country_event = {
						id = KMK.0019
					}
				}
				if = {
					limit = {
						has_country_leader = {
							ruling_only = yes
							name = "琪露诺"
						}
					}
					country_event = {
						id = KMK.0020
					}
				}
			}
		}
	}
	KMK_devaluation = {
		icon = ger_mefo_bills
		fire_only_once = no
		modifier = {
			consumer_goods_factor = 0.1
			industrial_capacity_factory = -0.1
		}
		days_remove = 120
		days_re_enable = 0
		cost = 0
		ai_will_do = {
			factor = 100
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -60
			}
		}
		remove_effect = {
			custom_effect_tooltip = KMK_effect_financial_crisis
			if = {
				limit = {
					not = {
						check_variable = {
							KMK_Financial_crisis_exincome = 0
						}
					}
				}
				add_to_variable = {
					KMK_Financial_crisis_exincome = -0.1
				}
				add_to_variable = {
					exincome_modifier = 0.1
				}
				custom_effect_tooltip = KMK_effect_money_tt_gain_10
			}
			add_to_variable = {
				KMK_Financial_crisis_stability_factor = 0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_war_support_factor = 0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_consumer_goods_factor = -0.1
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_devaluation_tt
		}
	}
	KMK_budget_deficit_law = {
		icon = eng_trade_unions_support
		fire_only_once = yes
		cost = 100
		ai_will_do = {
			factor = 100
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -80
			}
			custom_effect_tooltip = KMK_effect_financial_crisis
			if = {
				limit = {
					not = {
						check_variable = {
							KMK_Financial_crisis_exincome = 0
						}
					}
				}
				add_to_variable = {
					KMK_Financial_crisis_exincome = -0.1
				}
				add_to_variable = {
					exincome_modifier = 0.1
				}
				custom_effect_tooltip = KMK_effect_money_tt_gain_10
			}
			add_to_variable = {
				KMK_Financial_crisis_industrial_capacity_factory = 0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_industrial_capacity_dockyard = 0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_stability_factor = 0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_war_support_factor = 0.1
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_budget_deficit_law_tt
		}
	}
	KMK_exchange_rate_stabilisation = {
		icon = generic_scales
		fire_only_once = yes
		cost = 100
		ai_will_do = {
			factor = 100
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -80
			}
			custom_effect_tooltip = KMK_effect_financial_crisis
			if = {
				limit = {
					not = {
						check_variable = {
							KMK_Financial_crisis_exincome = 0
						}
					}
				}
				add_to_variable = {
					KMK_Financial_crisis_exincome = -0.1
				}
				add_to_variable = {
					exincome_modifier = 0.1
				}
				custom_effect_tooltip = KMK_effect_money_tt_gain_10
			}
			add_to_variable = {
				KMK_Financial_crisis_production_factory_efficiency_gain_factor = 0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_stability_factor = 0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_war_support_factor = 0.1
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_exchange_rate_stabilisation_tt
		}
	}
	KMK_agriculture_national_office = {
		icon = generic_shovels
		fire_only_once = yes
		cost = 100
		ai_will_do = {
			factor = 100
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -80
			}
			add_to_variable = {
				KMK_Financial_crisis_exincome = 0.1
			}
			add_to_variable = {
				exincome_modifier = -0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_consumer_goods_factor = -0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_stability_factor = 0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_war_support_factor = 0.1
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_agriculture_national_office_tt
		}
	}
	KMK_national_department_state_market = {
		icon = hol_attract_foreign_investors
		fire_only_once = yes
		cost = 25
		ai_will_do = {
			factor = 100
		}
		available = {
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -80
			}
			custom_effect_tooltip = KMK_effect_financial_crisis
			if = {
				limit = {
					not = {
						check_variable = {
							KMK_Financial_crisis_exincome = 0
						}
					}
				}
				add_to_variable = {
					KMK_Financial_crisis_exincome = -0.1
				}
				add_to_variable = {
					exincome_modifier = 0.1
				}
				custom_effect_tooltip = KMK_effect_money_tt_gain_10
			}
			add_to_variable = {
				KMK_Financial_crisis_production_factory_max_efficiency_factor = 0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_stability_factor = 0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_war_support_factor = 0.1
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_national_department_state_market_tt
		}
	}
	KMK_bank_france = {
		icon = generic_civil_support
		fire_only_once = yes
		modifier = {
			political_power_gain = 0.25
			stability_factor = -0.1
		}
		days_remove = 200
		cost = 25
		ai_will_do = {
			factor = 100
		}
		available = {
		}
		visible = {
		}
		complete_effect = {
			add_days_mission_timeout = {
				mission = KMK_goodbye_to_Financial_crisis
				days = -80
			}
		}
		remove_effect = {
			add_to_variable = {
				KMK_Financial_crisis_exincome = 0.2
			}
			add_to_variable = {
				exincome_modifier = -0.2
			}
			add_to_variable = {
				KMK_Financial_crisis_consumer_goods_factor = -0.1
			}
			add_to_variable = {
				KMK_Financial_crisis_production_speed_buildings_factor = 0.05
			}
			add_to_variable = {
				KMK_Financial_crisis_line_change_production_efficiency_factor = 0.05
			}
			add_to_variable = {
				KMK_Financial_crisis_industrial_capacity_factory = 0.05
			}
			add_to_variable = {
				KMK_Financial_crisis_industrial_capacity_dockyard = 0.05
			}
			add_to_variable = {
				KMK_Financial_crisis_production_factory_max_efficiency_factor = 0.05
			}
			add_to_variable = {
				KMK_Financial_crisis_production_factory_efficiency_gain_factor = 0.05
			}
			force_update_dynamic_modifier = yes
			custom_effect_tooltip = KMK_bank_france_tt
		}
	}
}
