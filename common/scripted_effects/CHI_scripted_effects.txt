ROOT_get_in_the_competition_for_China_reunification = {
	custom_effect_tooltip = Participate_in_the_competition_for_China_reunification
	set_country_flag = Participate_in_the_competition_for_China_reunification
	every_state = {
		limit = {
			has_state_flag = is_whole_chinese_state_area
			not = { is_core_of = ROOT }
		}
		add_claim_by = ROOT
	}
	ROOT = {
		CHI = { enable_country_integration_50_compliance = yes }
		ROC = { enable_country_integration_50_compliance = yes }
		PRC = { enable_country_integration_50_compliance = yes }
		CCC = { enable_country_integration_50_compliance = yes }
		SHH = { enable_country_integration_50_compliance = yes }
		YUN = { enable_country_integration_50_compliance = yes }
		SIC = { enable_country_integration_50_compliance = yes }
		XSM = { enable_country_integration_50_compliance = yes }
		MAN = { enable_country_integration_50_compliance = yes }
		ROC = { enable_country_integration_50_compliance = yes }
		FUJ = { enable_country_integration_50_compliance = yes }
		WUH = { enable_country_integration_50_compliance = yes }
		JSZ = { enable_country_integration_50_compliance = yes }
		MON = { enable_country_integration_80_compliance = yes }
		SIK = { enable_country_integration_80_compliance = yes }
		TIB = { enable_country_integration_80_compliance = yes }
		TRM = { enable_country_integration_80_compliance = yes }
	}
}

THIS_get_in_the_competition_for_China_reunification = {
	custom_effect_tooltip = Participate_in_the_competition_for_China_reunification
	set_country_flag = Participate_in_the_competition_for_China_reunification
	every_state = {
		limit = {
			has_state_flag = is_whole_chinese_state_area
			not = { is_core_of = PREV }
		}
		add_claim_by = PREV
	}
	CHI = { enable_country_integration_50_compliance = yes }
	ROC = { enable_country_integration_50_compliance = yes }
	PRC = { enable_country_integration_50_compliance = yes }
	CCC = { enable_country_integration_50_compliance = yes }
	SHH = { enable_country_integration_50_compliance = yes }
	YUN = { enable_country_integration_50_compliance = yes }
	SIC = { enable_country_integration_50_compliance = yes }
	XSM = { enable_country_integration_50_compliance = yes }
	MAN = { enable_country_integration_50_compliance = yes }
	ROC = { enable_country_integration_50_compliance = yes }
	FUJ = { enable_country_integration_50_compliance = yes }
	WUH = { enable_country_integration_50_compliance = yes }
	JSZ = { enable_country_integration_50_compliance = yes }
	MON = { enable_country_integration_80_compliance = yes }
	SIK = { enable_country_integration_80_compliance = yes }
	TIB = { enable_country_integration_80_compliance = yes }
	TRM = { enable_country_integration_80_compliance = yes }
}

CHI_Stable_society = {
	custom_effect_tooltip = CHI_Stable_society_tt
	if = {
		limit = {
			has_idea = CHI_Political_instability_4
		}
		remove_ideas = CHI_Political_instability_4
		set_country_flag = Stable_society_done
	}
	if = {
		limit = {
			has_idea = CHI_Political_instability_3
		}
		swap_ideas = {
			remove_idea = CHI_Political_instability_3
			add_idea = CHI_Political_instability_4
		}
	}
	if = {
		limit = {
			has_idea = CHI_Political_instability_2
		}
		swap_ideas = {
			remove_idea = CHI_Political_instability_2
			add_idea = CHI_Political_instability_3
		}
	}
	if = {
		limit = {
			has_idea = CHI_Political_instability_1
		}
		swap_ideas = {
			remove_idea = CHI_Political_instability_1
			add_idea = CHI_Political_instability_2
		}
	}
}

CHI_Famine_relief = {
	custom_effect_tooltip = CHI_Famine_relief_tt
	if = {
		limit = {
			has_idea = CHI_famine_5
		}
		remove_ideas = {
			CHI_famine_5
		}
	}
	if = {
		limit = {
			has_idea = CHI_famine_4
		}
		swap_ideas = {
			remove_idea = CHI_famine_4
			add_idea = CHI_famine_5
		}
	}
	if = {
		limit = {
			has_idea = CHI_famine_3
		}
		swap_ideas = {
			remove_idea = CHI_famine_3
			add_idea = CHI_famine_4
		}
	}
	if = {
		limit = {
			has_idea = CHI_famine_2
		}
		swap_ideas = {
			remove_idea = CHI_famine_2
			add_idea = CHI_famine_3
		}
	}
	if = {
		limit = {
			has_idea = CHI_famine_1
		}
		swap_ideas = {
			remove_idea = CHI_famine_1
			add_idea = CHI_famine_2
		}
	}
}

CHI_Improve_industry = {
	custom_effect_tooltip = CHI_Improve_industry_tt
	if = {
		limit = {
			has_idea = CHI_Deformed_industry_5
		}
		remove_ideas = CHI_Deformed_industry_5
	}
	if = {
		limit = {
			has_idea = CHI_Deformed_industry_4
		}
		swap_ideas = {
			remove_idea = CHI_Deformed_industry_4
			add_idea = CHI_Deformed_industry_5
		}
	}
	if = {
		limit = {
			has_idea = CHI_Deformed_industry_3
		}
		swap_ideas = {
			remove_idea = CHI_Deformed_industry_3
			add_idea = CHI_Deformed_industry_4
		}
	}
	if = {
		limit = {
			has_idea = CHI_Deformed_industry_2
		}
		swap_ideas = {
			remove_idea = CHI_Deformed_industry_2
			add_idea = CHI_Deformed_industry_3
		}
	}
	if = {
		limit = {
			has_idea = CHI_Deformed_industry_1
		}
		swap_ideas = {
			remove_idea = CHI_Deformed_industry_1
			add_idea = CHI_Deformed_industry_2
		}
	}
}

CHI_huanjiexingzhengyali = {
	custom_effect_tooltip = CHI_huanjiexingzhengyali_tt
	if = {
		limit = {
			has_idea = ROC_crushed_country_4
		}
		remove_ideas = ROC_crushed_country_4
	}
	if = {
		limit = {
			has_idea = ROC_crushed_country_3
		}
		swap_ideas = {
			remove_idea = ROC_crushed_country_3
			add_idea = ROC_crushed_country_4
		}
	}
	if = {
		limit = {
			has_idea = ROC_crushed_country_2
		}
		swap_ideas = {
			remove_idea = ROC_crushed_country_2
			add_idea = ROC_crushed_country_3
		}
	}
	if = {
		limit = {
			has_idea = ROC_crushed_country_1
		}
		swap_ideas = {
			remove_idea = ROC_crushed_country_1
			add_idea = ROC_crushed_country_2
		}
	}
}

ROC_remove_all_ideas = {
	hidden_effect = {
		remove_ideas = {
			ROC_Changli_idea
			ROC_Wang_Jingwei_idea
			ROC_Wang_Jingwei_idea2
			ROC_Wang_Jingwei_idea3
			ROC_ChIang_Kaishek_idea
			ROC_ChIang_Kaishek_idea2
			ROC_Provisional_Senate_idea
		}
	}
}

ROC_Democratic_elections_vice_president = {
	hidden_effect = {
		if = {
			limit = {
				has_country_leader = {
					ruling_only = yes
					character = ROC_ChIang_Kaishek
				}
			}
			ROC_remove_all_ideas = yes
			add_ideas = ROC_ChIang_Kaishek_idea2
		}
		if = {
			limit = {
				has_country_leader = {
					ruling_only = yes
					character = ROC_Wang_Jingwei
				}
			}
			ROC_remove_all_ideas = yes
			add_ideas = ROC_Wang_Jingwei_idea3
		}
	}
}

PRC_remove_all_ideas = {
	hidden_effect = {
		remove_ideas = {
			PRC_lidesheng_idea
			PRC_cornered_fox_idea
			PRC_Shu_idea
			PRC_lin_miao_idea
			PRC_Yoshida_Yuko_idea
			PRC_Zheng_chaolin_idea
		}
	}
}

# 保持原政府傀儡-中国军阀
CHI_puppet_released_tag_and_old_govern = {
 ##原政府变量
	var:tag_to_release = {
		hidden_effect = {
			set_variable = { old_govern_democratic_popularity = ROOT.party_popularity_100@democratic }
			clamp_variable = {
				var = old_govern_democratic_popularity
				min = 0
				max = 100
			}
			set_variable = { old_govern_communism_popularity = ROOT.party_popularity_100@communism }
			clamp_variable = {
				var = old_govern_communism_popularity
				min = 0
				max = 100
			}
			set_variable = { old_govern_neutrality_popularity = ROOT.party_popularity_100@neutrality }
			clamp_variable = {
				var = old_govern_neutrality_popularity
				min = 0
				max = 100
			}
			set_variable = { old_govern_fascism_popularity = ROOT.party_popularity_100@fascism }
			clamp_variable = {
				var = old_govern_fascism_popularity
				min = 0
				max = 100
			}
			if = {
				limit = {
					has_government = democratic
				}
				set_country_flag = old_govern_is_democratic_flag
			}
			if = {
				limit = {
					has_government = neutrality
				}
				set_country_flag = old_govern_is_neutral_flag
			}
			if = {
				limit = {
					has_government = communism
				}
				set_country_flag = old_govern_is_communistic_flag
			}
			if = {
				limit = {
					has_government = fascism
				}
				set_country_flag = old_govern_is_fascist_flag
			}
		}
	}
	custom_effect_tooltip = puppet_released_tag_and_old_govern_tt
 ##傀儡等级
	set_autonomy = {
		target = var:tag_to_release
		autonomous_state = China_Provinces
	}
 ##设置原政府
	var:tag_to_release = {
		hidden_effect = {
			set_popularities = {
				democratic = old_govern_democratic_popularity
				fascism = old_govern_fascism_popularity
				communism = old_govern_communism_popularity
				neutrality = old_govern_neutrality_popularity
			}
			if = {
				limit = {
					has_country_flag = old_govern_is_democratic_flag
				}
				set_politics = { ruling_party = democratic }
			}
			if = {
				limit = {
					has_country_flag = old_govern_is_neutral_flag
				}
				set_politics = { ruling_party = neutrality }
			}
			if = {
				limit = {
					has_country_flag = old_govern_is_communistic_flag
				}
				set_politics = { ruling_party = communism }
			}
			if = {
				limit = {
					has_country_flag = old_govern_is_fascist_flag
				}
				set_politics = { ruling_party = fascism }
			}
		}
		drop_cosmetic_tag = yes
		mark_focus_tree_layout_dirty = yes
 ##设置修饰性tag
		if = {
			limit = { PREV = { tag = CHI } }
			if = {
				limit = { tag = SIC }
				set_cosmetic_tag = SIC_CHI
			}
			if = {
				limit = { tag = FUJ }
				set_cosmetic_tag = FUJ_CHI
			}
			if = {
				limit = { tag = JSZ }
				set_cosmetic_tag = JSZ_CHI
			}
			if = {
				limit = { tag = SHD }
				set_cosmetic_tag = SHD_CHI
			}
			if = {
				limit = { tag = WUH }
				set_cosmetic_tag = WUH_CHI
			}
			if = {
				limit = { tag = YUM }
				set_cosmetic_tag = YUM_CHI
			}
			if = {
				limit = { tag = ROC }
				set_cosmetic_tag = ROC_CHI
			}
			if = {
				limit = { tag = XSM }
				set_cosmetic_tag = XSM_CHI
			}
			if = {
				limit = { tag = YUN }
				set_cosmetic_tag = YUN_CHI
			}
			if = {
				limit = { tag = MON }
				set_cosmetic_tag = MON_CHI
			}
			if = {
				limit = { tag = SIK }
				set_cosmetic_tag = SIK_CHI
			}
			if = {
				limit = { tag = TIB }
				set_cosmetic_tag = TIB_CHI
			}
			if = {
				limit = { tag = GXC }
				set_cosmetic_tag = GXC_CHI
			}
			if = {
				limit = { tag = MAN }
				set_cosmetic_tag = MAN_CHI
			}
			if = {
				limit = { tag = RYU }
				set_cosmetic_tag = RYU_CHI
			}
		}
		if = {
			limit = { PREV = { tag = ROC } }
			if = {
				limit = { tag = SIC }
				set_cosmetic_tag = SIC_ROC
			}
			if = {
				limit = { tag = FUJ }
				set_cosmetic_tag = FUJ_ROC
			}
			if = {
				limit = { tag = JSZ }
				set_cosmetic_tag = JSZ_ROC
			}
			if = {
				limit = { tag = SHD }
				set_cosmetic_tag = SHD_ROC
			}
			if = {
				limit = { tag = WUH }
				set_cosmetic_tag = WUH_ROC
			}
			if = {
				limit = { tag = YUM }
				set_cosmetic_tag = YUM_ROC
			}
			if = {
				limit = { tag = ROC }
				set_cosmetic_tag = ROC_ROC
			}
			if = {
				limit = { tag = XSM }
				set_cosmetic_tag = XSM_ROC
			}
			if = {
				limit = { tag = YUN }
				set_cosmetic_tag = YUN_ROC
			}
			if = {
				limit = { tag = MON }
				set_cosmetic_tag = MON_ROC
			}
			if = {
				limit = { tag = SIK }
				set_cosmetic_tag = SIK_ROC
			}
			if = {
				limit = { tag = TIB }
				set_cosmetic_tag = TIB_ROC
			}
			if = {
				limit = { tag = GXC }
				set_cosmetic_tag = GXC_ROC
			}
			if = {
				limit = { tag = MAN }
				set_cosmetic_tag = MAN_ROC
			}
			if = {
				limit = { tag = RYU }
				set_cosmetic_tag = RYU_ROC
			}
		}
		if = {
			limit = { PREV = { tag = PRC } }
			if = {
				limit = { tag = SIC }
				set_cosmetic_tag = SIC_PRC
			}
			if = {
				limit = { tag = FUJ }
				set_cosmetic_tag = FUJ_PRC
			}
			if = {
				limit = { tag = JSZ }
				set_cosmetic_tag = JSZ_PRC
			}
			if = {
				limit = { tag = SHD }
				set_cosmetic_tag = SHD_PRC
			}
			if = {
				limit = { tag = WUH }
				set_cosmetic_tag = WUH_PRC
			}
			if = {
				limit = { tag = YUM }
				set_cosmetic_tag = YUM_PRC
			}
			if = {
				limit = { tag = ROC }
				set_cosmetic_tag = ROC_PRC
			}
			if = {
				limit = { tag = XSM }
				set_cosmetic_tag = XSM_PRC
			}
			if = {
				limit = { tag = YUN }
				set_cosmetic_tag = YUN_PRC
			}
			if = {
				limit = { tag = MON }
				set_cosmetic_tag = MON_PRC
			}
			if = {
				limit = { tag = SIK }
				set_cosmetic_tag = SIK_PRC
			}
			if = {
				limit = { tag = TIB }
				set_cosmetic_tag = TIB_PRC
			}
			if = {
				limit = { tag = GXC }
				set_cosmetic_tag = GXC_PRC
			}
			if = {
				limit = { tag = MAN }
				set_cosmetic_tag = MAN_PRC
			}
			if = {
				limit = { tag = RYU }
				set_cosmetic_tag = RYU_PRC
			}
		}
	}
 ##启动整合决议
	if = {
		limit = { PREV = { tag = PRC } }
		activate_targeted_decision = {
			target = var:tag_to_release
			decision = PRC_integration_FROM
		}
	}
	else = {
		activate_targeted_decision = {
			target = var:tag_to_release
			decision = CHI_integration_FROM
		}
	}
}

#落日
JAP_peace_with_unit_font = {
	hidden_effect = {
		if = {
			limit = {
				NOT = { has_global_flag = JAP_Fading_Sun }
			}
			set_global_flag = JAP_Fading_Sun
			JAP = {
				#清除了残余战争借口
				every_enemy_country = {
					JAP = {
						remove_wargoal = {
							type = all
							target = PREV
						}
					}
				}
				#附庸国独立（中国区）
				if = {
					limit = { exists = yes }
					every_country = {
						limit = {
							OR = {
								is_guaranteed_by = PREV
								is_subject_of = PREV
								has_non_aggression_pact_with = PREV
								has_military_access_to = PREV
								gives_military_access_to = PREV
							}
							is_chinese_country = yes
						}
						diplomatic_relation = {
							country = JAP
							relation = military_access
							active = no
						}
						JAP = {
							if = {
								limit = { has_subject = PREV }
								set_autonomy = {
									target = PREV
									autonomy_state = autonomy_free
								}
							}
							diplomatic_relation = {
								country = PREV
								relation = guarantee
								active = no
							}
							diplomatic_relation = {
								country = PREV
								relation = non_aggression_pact
								active = no
							}
							diplomatic_relation = {
								country = PREV
								relation = military_access
								active = no
							}
						}
					}
				}
			}
			#清除本土外的核心与宣称（国区）
			every_state = {
				limit = { has_state_flag = is_whole_chinese_state_area }
				remove_core_of = JAP
				remove_claim_by = JAP
			}
			#日本条约领
			create_dynamic_country = {
				original_tag = JAP
				copy_tag = JAP
				save_global_event_target_as = JAP_peace_conference_tag
				set_country_flag = { flag = disabled_annexations days = 15 value = 1 }
				set_politics = { ruling_party = neutrality }
				set_political_party = { ideology = neutrality popularity = 100 }
				ROOT = {
					every_enemy_country = {
						limit = { is_chinese_country = yes }
						event_target:JAP_peace_conference_tag = {
							add_to_war = {
								targeted_alliance = ROOT
								enemy = PREV
							}
						}
					}
					every_owned_state = {
						limit = {
							or = {
								has_state_flag = is_whole_chinese_state_area
								region = 191
							}
						}
						add_core_of = event_target:JAP_peace_conference_tag
						if = {
							limit = {
								OR = {
									is_fully_controlled_by = ROOT
									state = 745
								}
							}
							event_target:JAP_peace_conference_tag = { transfer_state = PREV }
						}
						else = {
							event_target:JAP_peace_conference_tag = { set_state_owner = PREV }
						}
					}
				}
				add_timed_idea = {
					idea = ready_to_surrender
					days = 15
				}
				set_cosmetic_tag = JAP_treaty
				every_enemy_country = {
					limit = { is_chinese_country = no }
					white_peace = { 
						tag = PREV
					}
				}
			}
			#中国盟友-离开阵营
			every_country = {
				limit = {
					is_in_faction_with = JAP
					is_chinese_country = yes
				}
				leave_faction = yes
				every_enemy_country = {
					limit = { is_chinese_country = no }
					white_peace = { tag = PREV }
				}
			}
			#白和
			ROOT = { white_peace = { tag = FROM } }
		}
	}
}