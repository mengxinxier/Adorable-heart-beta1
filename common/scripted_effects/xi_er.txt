GER_BACK = {
	GER = {
		load_focus_tree = germany_focus
	}
	hidden_effect = {
		news_event = {
			id = austria.1666
			days = 1
		}
	}
	KMS = {
		every_character = {
			set_nationality = GER
		}
	}
	GER = {
		annex_country = {
			target = AUS
			transfer_troops = yes
		}
		annex_country = {
			target = KMS
			transfer_troops = yes
		}
		complete_national_focus = GER_01
	}
	every_country = {
		limit = {
			is_in_faction_with = GER
			NOT = {
				tag = GER
			}
			NOT = {
				is_subject_of = GER
			}
		}
		every_controlled_state = {
			limit = {
				has_state_flag = L_GER
				not = {
					or = {
						is_core_of = PREV
						is_claimed_by = PREV
					}
				}
			}
			GER = {
				transfer_state = PREV
			}
			PREV = {
				country_event = {
					id = austria.06
				}
			}
		}
	}
	every_country = {
		limit = {
			is_in_faction_with = GER
			NOT = {
				tag = GER
			}
			is_subject_of = GER
		}
		every_controlled_state = {
			limit = {
				has_state_flag = L_GER
			}
			GER = {
				transfer_state = PREV
			}
			PREV = {
				country_event = {
					id = austria.06
				}
			}
		}
	}
	every_state = {
		limit = {
			has_state_flag = L_GER
		}
		add_core_of = GER
	}
	every_state = {
		limit = {
			is_core_of = DVL
		}
		remove_core_of = DVL
	}
	every_state = {
		limit = {
			is_claim_by = DVL
		}
		remove_claim_by = DVL
	}
	every_state = {
		limit = {
			is_claim_by = GER
			is_core_of = GER
		}
		remove_claim_by = GER
	}
	GER = {
		country_event = {
			id = ah_germany.01
			days = 2
		}
	}
}

GEU_econmic_scar_xuejian = {
	custom_effect_tooltip = GEU_econmic_scar_xuejian
	if = {
		limit = {
			has_idea = geu_civil_econmic_scar
		}
		swap_ideas = {
			remove_idea = geu_civil_econmic_scar
			add_idea = geu_civil_econmic_scar_1
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_econmic_scar_1
		}
		swap_ideas = {
			remove_idea = geu_civil_econmic_scar_1
			add_idea = geu_civil_econmic_scar_2
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_econmic_scar_2
		}
		swap_ideas = {
			remove_idea = geu_civil_econmic_scar_2
			add_idea = geu_civil_econmic_scar_3
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_econmic_scar_3
		}
		swap_ideas = {
			remove_idea = geu_civil_econmic_scar_3
			add_idea = geu_civil_econmic_scar_4
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_econmic_scar_4
		}
		swap_ideas = {
			remove_idea = geu_civil_econmic_scar_4
			add_idea = geu_civil_econmic_scar_5
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_econmic_scar_5
		}
		remove_ideas = geu_civil_econmic_scar_5
	}
}

ENG_great_peace = {
	if = {
		limit = {
			FRA = {
				is_in_faction_with = ENG
			}
		}
		FRA = {
			leave_faction = yes
		}
	}
	if = {
		limit = {
			FRA = {
				has_capitulated = yes
			}
		}
		DVL_ENG_GUAFEN_FRA = yes
	}
	ENG = {
		white_peace = {
			tag = DVL
			message = ENG_great_peace_ENG
		}
	}
	every_country = {
		limit = {
			is_subject = no
			is_in_faction_with = ENG
			NOT = {
				tag = ENG
			}
		}
		country_event = {
			id = deviluke.56
		}
	}
}

DVL_ENG_GUAFEN_FRA = {
	983 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	14 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	30 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	23 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	25 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	26 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	19 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	31 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	22 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	779 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	984 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	817 = {
		limit = {
			or = {
				DVL = {
					controls_state = PREV
				}
				any_country = {
					is_subject_of = DVL
					controls_state = PREV
				}
			}
		}
		ENF = {
			transfer_state = PREV
		}
	}
	every_state = {
		limit = {
			has_state_flag = FRAZDQ
		}
		add_core_of = ENF
	}
	every_state = {
		limit = {
			is_controlled_by = ENG
			is_core_of = ENF
		}
		ENF = {
			transfer_state = PREV
		}
	}
	ENG = {
		set_autonomy = {
			target = ENF
			autonomy_state = autonomy_reichskommissariat
		}
	}
	ENF = {
		inherit_technology = ENG
	}
}

GER_ZHENGZHI_BETTER = {
	custom_effect_tooltip = GER_ZHENGZHI_BETTER
	if = {
		limit = {
			has_idea = GER_worst_social
		}
		swap_ideas = {
			remove_idea = GER_worst_social
			add_idea = GER_worst_social_1
		}
	}
	else_if = {
		limit = {
			has_idea = GER_worst_social_1
		}
		swap_ideas = {
			remove_idea = GER_worst_social_1
			add_idea = GER_worst_social_2
		}
	}
	else_if = {
		limit = {
			has_idea = GER_worst_social_2
		}
		swap_ideas = {
			remove_idea = GER_worst_social_2
			add_idea = GER_worst_social_3
		}
	}
	else_if = {
		limit = {
			has_idea = GER_worst_social_3
		}
		remove_ideas = GER_worst_social_3
	}
}

GEU_ZHENGZHI_BETTER = {
	custom_effect_tooltip = GER_ZHENGZHI_BETTER
	if = {
		limit = {
			has_idea = geu_civil_social_scar
		}
		swap_ideas = {
			remove_idea = geu_civil_social_scar
			add_idea = geu_civil_social_scar_1
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_social_scar_1
		}
		swap_ideas = {
			remove_idea = geu_civil_social_scar_1
			add_idea = geu_civil_social_scar_2
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_social_scar_2
		}
		swap_ideas = {
			remove_idea = geu_civil_social_scar_2
			add_idea = geu_civil_social_scar_3
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_social_scar_3
		}
		swap_ideas = {
			remove_idea = geu_civil_social_scar_3
			add_idea = geu_civil_social_scar_4
		}
	}
	else_if = {
		limit = {
			has_idea = geu_civil_social_scar_4
		}
		remove_ideas = geu_civil_social_scar_4
	}
}

ENG_JIETI = {
	hidden_effect = {
		every_country = {
			limit = {
				is_in_faction_with = ENG
				not = {
					tag = ENG
				}
			}
			set_country_flag = former_eng_country
			add_to_temp_array = {
				global.former_eng_members = THIS
			}
		}
		ENG = {
			dismantle_faction = yes
			set_country_flag = has_capitulated
		}
		ENG = {
			every_subject_country = {
				PREV = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_free
					}
				}
			}
		}
		every_country = {
			limit = {
				has_country_flag = former_eng_country
			}
			# ENG = {
			# 	set_autonomy = {
			# 		target = PREV
			# 		autonomy_state = autonomy_free
			# 	}
			# }
			leave_faction = yes
		}
		every_country = {
			limit = {
				has_country_flag = former_eng_country
				has_capitulated = yes
			}
			# ENG = {
			# 	set_autonomy = {
			# 		target = PREV
			# 		autonomy_state = autonomy_free
			# 	}
			# }
			country_event = {
				id = eng.668
				days = 4
			}
		}
		for_each_scope_loop = {
			array = global.former_eng_members
			for_each_scope_loop = {
				array = global.former_eng_members
				if = {
					limit = {
						NOT = {
							tag = PREV
						}
					}
					give_military_access = PREV
				}
			}
		}
		every_country = {
			limit = {
				has_country_flag = former_eng_country
				NOT = {
					surrender_progress>0
				}
				not = {
					capital_scope = {
						is_on_continent = europe
					}
				}
			}
			every_enemy_country = {
				white_peace = PREV
			}
		}
		LIB = {
			limit = {
				has_country_flag = former_eng_country
				NOT = {
					surrender_progress>0
				}
			}
			every_enemy_country = {
				white_peace = PREV
			}
		}
		# every_country = {
		# 	limit = {
		# 		has_country_flag = former_eng_country
		# 		NOT = {
		# 			surrender_progress>0
		# 		}
		# 	}
		# 	faction_collapse_member_peace_effect = yes
		# }
	}
}

faction_collapse_member_peace_effect = {
	leave_faction = yes
	#Step one: peace out with any faction leaders who aren't neighbours of/invading PREV or claiming PREV territory
	save_event_target_as = peace_country
	every_enemy_country = {
		limit = {
			is_faction_leader = yes
			OR = {
				capital_scope = {
					is_island_region = yes
				}
				same_continent_as_PREV = no
			}
			NOT = {
				civilwar_target = PREV				#do not peace out civil wars
				PREV = {
					OR = {
						any_home_area_neighbor_country = {
							tag = PREV.PREV
						}
						#== invading
						any_owned_state = {
							OR = {
								is_core_of = PREV.PREV
								is_claimed_by = PREV.PREV
							}
						}
					}
				}
				any_allied_country = {
					event_target:peace_country = {
						OR = {
							any_home_area_neighbor_country = {
								tag = PREV.PREV
							}
							#== invading
							any_owned_state = {
								OR = {
									is_core_of = PREV.PREV
									is_claimed_by = PREV.PREV
								}
							}
						}
					}
				}
			}
		}
		white_peace = PREV
	}
	#Step two: peace out with any factionless non-neighbours not on the same continent who aren't invading PREV or claiming PREV territory
	every_enemy_country = {
		limit = {
			is_in_faction = no
			is_subject = no
			has_capitulated = no
			OR = {
				capital_scope = {
					is_island_region = yes
				}
				same_continent_as_PREV = no
			}
			NOT = {
				civilwar_target = PREV				#do not peace out civil wars
				PREV = {
					OR = {
						any_home_area_neighbor_country = {
							#== invading
							OR = {
								tag = PREV.PREV
								is_subject_of = PREV.PREV
							}
						}
						any_owned_state = {
							OR = {
								is_core_of = PREV.PREV
								is_claimed_by = PREV.PREV
							}
						}
					}
				}
				any_subject_country = {
					event_target:peace_country = {
						OR = {
							any_home_area_neighbor_country = {
								#== invading
								OR = {
									tag = PREV.PREV
									is_subject_of = PREV.PREV
								}
							}
							any_owned_state = {
								OR = {
									is_core_of = PREV.PREV
									is_claimed_by = PREV.PREV
								}
							}
						}
					}
				}
			}
		}
		white_peace = PREV
	}
}

transfer_int_upgrade = {
	hidden_effect = {
		### agency ###
		if = {
			limit = {
				NOT = {
					has_intelligence_agency = yes
				}
				PREV = {
					has_intelligence_agency = yes
				}
			}
			create_intelligence_agency = yes
		}
		### branch_intelligence ###
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_economy_civilian
				}
				PREV = {
					has_done_agency_upgrade = upgrade_economy_civilian
				}
			}
			upgrade_intelligence_agency = upgrade_economy_civilian
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_army_department
				}
				PREV = {
					has_done_agency_upgrade = upgrade_army_department
				}
			}
			upgrade_intelligence_agency = upgrade_army_department
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_naval_department
				}
				PREV = {
					has_done_agency_upgrade = upgrade_naval_department
				}
			}
			upgrade_intelligence_agency = upgrade_naval_department
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_airforce_department
				}
				PREV = {
					has_done_agency_upgrade = upgrade_airforce_department
				}
			}
			upgrade_intelligence_agency = upgrade_airforce_department
		}
		### branch_defense ###
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_passive_defense
				}
				PREV = {
					has_done_agency_upgrade = upgrade_passive_defense
				}
			}
			upgrade_intelligence_agency = upgrade_passive_defense
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_anti_partisan
				}
				PREV = {
					has_done_agency_upgrade = upgrade_anti_partisan
				}
			}
			upgrade_intelligence_agency = upgrade_anti_partisan
		}
		### branch_operation ###
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_blueprint_stealing
				}
				PREV = {
					has_done_agency_upgrade = upgrade_blueprint_stealing
				}
			}
			upgrade_intelligence_agency = upgrade_blueprint_stealing
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_portable_radios
				}
				PREV = {
					has_done_agency_upgrade = upgrade_portable_radios
				}
			}
			upgrade_intelligence_agency = upgrade_portable_radios
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_invisible_ink
				}
				PREV = {
					has_done_agency_upgrade = upgrade_invisible_ink
				}
			}
			upgrade_intelligence_agency = upgrade_invisible_ink
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_plastic_explosives
				}
				PREV = {
					has_done_agency_upgrade = upgrade_plastic_explosives
				}
			}
			upgrade_intelligence_agency = upgrade_plastic_explosives
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_suicide_pills
				}
				PREV = {
					has_done_agency_upgrade = upgrade_suicide_pills
				}
			}
			upgrade_intelligence_agency = upgrade_suicide_pills
		}
		### branch_operative ###
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_training_centers
				}
				PREV = {
					has_done_agency_upgrade = upgrade_training_centers
				}
			}
			upgrade_intelligence_agency = upgrade_training_centers
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_commando_training
				}
				PREV = {
					has_done_agency_upgrade = upgrade_commando_training
				}
			}
			upgrade_intelligence_agency = upgrade_commando_training
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_interrogation_techniques
				}
				PREV = {
					has_done_agency_upgrade = upgrade_interrogation_techniques
				}
			}
			upgrade_intelligence_agency = upgrade_interrogation_techniques
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_diplo_training
				}
				PREV = {
					has_done_agency_upgrade = upgrade_diplo_training
				}
			}
			upgrade_intelligence_agency = upgrade_diplo_training
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_psycho_warfare
				}
				PREV = {
					has_done_agency_upgrade = upgrade_psycho_warfare
				}
			}
			upgrade_intelligence_agency = upgrade_psycho_warfare
		}
		### branch_crypto ###
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_form_department
				}
				PREV = {
					has_done_agency_upgrade = upgrade_form_department
				}
			}
			upgrade_intelligence_agency = upgrade_form_department
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_decryption_boost
				}
				PREV = {
					has_done_agency_upgrade = upgrade_decryption_boost
				}
			}
			upgrade_intelligence_agency = upgrade_decryption_boost
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_decryption_boost_2
				}
				PREV = {
					has_done_agency_upgrade = upgrade_decryption_boost_2
				}
			}
			upgrade_intelligence_agency = upgrade_decryption_boost_2
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_crypto_strength
				}
				PREV = {
					has_done_agency_upgrade = upgrade_crypto_strength
				}
			}
			upgrade_intelligence_agency = upgrade_crypto_strength
		}
		if = {
			limit = {
				NOT = {
					has_done_agency_upgrade = upgrade_crypto_strength_2
				}
				PREV = {
					has_done_agency_upgrade = upgrade_crypto_strength_2
				}
			}
			upgrade_intelligence_agency = upgrade_crypto_strength_2
		}
	}
}

sheri_faction = {
	if = {
		limit = {
			any_country = {
				not = {
					or = {
						tag = GER
						is_subject_of = GER
						is_in_faction_with = GER
					}
				}
				is_faction_leader = yes
			}
		}
		random_country = {
			limit = {
				not = {
					or = {
						tag = GER
						is_subject_of = GER
						is_in_faction_with = GER
					}
				}
				is_faction_leader = yes
			}
			set_faction_name = "射日同萌"
			every_other_country = {
				limit = {
					not = {
						or = {
							tag = GER
							is_subject_of = GER
							is_in_faction_with = GER
							is_in_faction_with = PREV
						}
					}
				}
				PREV = {
					add_to_faction = PREV
				}
			}
			declare_war_on = {
				target = GER
				type = annex_everything
			}
		}
	}
	else = {
		random_country = {
			limit = {
				not = {
					or = {
						tag = GER
						is_subject_of = GER
						is_in_faction_with = GER
					}
				}
				#is_faction_leader = yes
			}
			create_faction = "射日同萌"
			every_other_country = {
				limit = {
					not = {
						or = {
							tag = GER
							is_subject_of = GER
							is_in_faction_with = GER
							is_in_faction_with = PREV
						}
					}
				}
				PREV = {
					add_to_faction = PREV
				}
			}
			declare_war_on = {
				target = GER
				type = annex_everything
			}
		}
	}
}

FRA_special_reasearch_effect = {
	if = {
		limit = {
			check_variable = {
				helicoptery_reasearch_name = 1
			}
		}
		set_variable = {
			helicoptery_reasearch_ing = 1
		}
		activate_mission = 1940helicoptery_ing
	}
	else_if = {
		limit = {
			check_variable = {
				helicoptery_reasearch_name = 2
			}
		}
		set_variable = {
			helicoptery_reasearch_ing = 2
		}
		activate_mission = 1943helicoptery_ing
	}
	else_if = {
		limit = {
			check_variable = {
				helicoptery_reasearch_name = 3
			}
		}
		set_variable = {
			helicoptery_reasearch_ing = 3
		}
		activate_mission = 1946helicoptery_ing
	}
	else_if = {
		limit = {
			check_variable = {
				helicoptery_reasearch_name = 4
			}
		}
		set_variable = {
			helicoptery_reasearch_ing = 4
		}
		activate_mission = 1950helicoptery_ing
	}
	else_if = {
		limit = {
			check_variable = {
				helicoptery_reasearch_name = 5
			}
		}
		set_variable = {
			helicoptery_reasearch_ing = 5
		}
		activate_mission = 1955helicoptery_ing
	}
}

change_to_war_economy = {
	if = {
		limit = {
			has_idea = undisturbed_isolation
		}
		swap_ideas = {
			remove_idea = undisturbed_isolation
			add_idea = war_economy
		}
	}
	else_if = {
		limit = {
			has_idea = isolation
		}
		swap_ideas = {
			remove_idea = isolation
			add_idea = war_economy
		}
	}
	else_if = {
		limit = {
			has_idea = wanglingjingji
		}
		swap_ideas = {
			remove_idea = wanglingjingji
			add_idea = war_economy
		}
	}
	else_if = {
		limit = {
			has_idea = civilian_economy
		}
		swap_ideas = {
			remove_idea = civilian_economy
			add_idea = war_economy
		}
	}
	else_if = {
		limit = {
			has_idea = low_economic_mobilisation
		}
		swap_ideas = {
			remove_idea = low_economic_mobilisation
			add_idea = war_economy
		}
	}
	else_if = {
		limit = {
			has_idea = partial_economic_mobilisation
		}
		swap_ideas = {
			remove_idea = partial_economic_mobilisation
			add_idea = war_economy
		}
	}
	else = {
		add_ideas = war_economy
	}
}

ah_music_start = {
	if = {
		limit = {
			has_global_flag = AH_music_on
		}
		if = {
			limit = {
				tag = SOV
			}
			scoped_play_song = "牢不可破的联盟"
		}
		if = {
			limit = {
				tag = ENG
			}
			scoped_play_song = "统治吧不列颠尼亚 希望与光荣之土"
		}
		if = {
			limit = {
				tag = GER
			}
			scoped_play_song = "Das Lied der Deutschen"
		}
		if = {
			limit = {
				OR = {
					tag = FRA
					tag = KMK
				}
			}
			scoped_play_song = "众神眷恋的幻想乡"
		}
	}
}

add_core_of_ROOT = {
	if = {
		limit = {
			is_claimed_by = ROOT
		}
		remove_claim_by = ROOT
	}
	add_core_of = ROOT
}

GER_economic_recovery_ww = {
	custom_effect_tooltip = GER_economic_recovery_tt
	if = {
		limit = {
			has_idea = GER_serious_lose_job_1
		}
		swap_ideas = {
			remove_idea = GER_serious_lose_job_1
			add_idea = GER_serious_lose_job
		}
	}
	else_if = {
		limit = {
			has_idea = GER_serious_lose_job
		}
		swap_ideas = {
			remove_idea = GER_serious_lose_job
			add_idea = GER_serious_lose_job_2
		}
	}
	else_if = {
		limit = {
			has_idea = GER_serious_lose_job_2
		}
		swap_ideas = {
			remove_idea = GER_serious_lose_job_2
			add_idea = GER_serious_lose_job_3
		}
	}
	else_if = {
		limit = {
			has_idea = GER_serious_lose_job_3
		}
		remove_ideas = GER_serious_lose_job_3
	}
}

#计算太空竞赛
generate_Space_race_rankings = {
	clear_array = global.Space_race_countries
	every_country = {
		limit = {
			has_country_flag = add_to_Space_Race
			has_tech = rocket_engines
			NOT = {
				or = {
					tag = DVL
					tag = RJE
				}
			}
		}
		add_to_array = {
			global.Space_race_countries = THIS
		}
	}
	get_sorted_scored_countries = {
		scorer = Space_race_scorer
		array = global.Space_race_countries
	}
	# Set up ranking positions
	for_each_scope_loop = {
		array = global.Space_race_countries
		add_to_variable = {
			global.Space_race_countries_index = 1
		}
		set_variable = {
			Space_race_ranking = global.Space_race_countries_index
		}
	}
	clear_variable = global.Space_race_countries_index
}

NGD_unit_NA_effect = {
	set_cosmetic_tag = NGD_NA
}

NGD_Alleviating_the_Great_Depression = {
	custom_effect_tooltip = GER_economic_recovery_tt
	if = {
		limit = {
			has_idea = NGD_The_Great_Depression
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression
			add_idea = NGD_The_Great_Depression_1
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_1
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_1
			add_idea = NGD_The_Great_Depression_2
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_2
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_2
			add_idea = NGD_The_Great_Depression_3
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_3
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_3
			add_idea = NGD_The_Great_Depression_4
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_4
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_4
			add_idea = NGD_The_Great_Depression_5
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_5
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_5
			add_idea = NGD_The_Great_Depression_6
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_6
		}
		swap_ideas = {
			remove_idea = NGD_The_Great_Depression_6
			add_idea = NGD_The_Great_Depression_7
		}
	}
	else_if = {
		limit = {
			has_idea = NGD_The_Great_Depression_7
		}
		remove_ideas = NGD_The_Great_Depression_7
	}
}

GER_get_a_governor_to_PREV = {
	if = {
		limit = {
			has_character = GER_Konrad_Adenauer
			GER_Konrad_Adenauer = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "俾斯麦"
				desc = ""
				picture = "gfx/leaders/GER/Konrad_Adenauer.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_Konrad_Adenauer = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_gerd_von_rundstedt
			GER_gerd_von_rundstedt = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "格尔德·冯·伦德斯泰特"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_Gerd_von_Rundstedt.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_gerd_von_rundstedt = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_joseph_goebbels
			GER_joseph_goebbels = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "约瑟夫·戈培尔"
				desc = ""
				picture = "gfx/leaders/GER/joseph_goebbels.dds"
				expire = "1985.1.1"
				ideology = Strasserism
				traits = {
				}
			}
		}
		GER_joseph_goebbels = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			not = {
				has_idea = GER_xier_idea
			}
			has_character = GER_xier
			GER_xier = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "希尔"
				desc = ""
				picture = "gfx/leaders/GER/AUS_xier.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_xier = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			not = {
				has_idea = GER_heinrich_himmler_idea
			}
			has_character = GER_heinrich_himmler
			GER_heinrich_himmler = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "海因里希·希姆莱"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_Heinrich_Himmler.dds"
				expire = "1985.1.1"
				ideology = occultism
				traits = {
				}
			}
		}
		GER_heinrich_himmler = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_maiye
			GER_maiye = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "赫尔曼·麦椰"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_Hermann_Goring.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_maiye = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_Tanya
			GER_Tanya = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "谭雅·提古雷查夫"
				desc = ""
				picture = "gfx/leaders/GER/AUS_TANYA.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_Tanya = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_ailika
			GER_ailika = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "逸见艾丽卡"
				desc = ""
				picture = "gfx/leaders/GER/GER_Erika_13.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_ailika = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_zhensui
			GER_zhensui = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "西住真穗"
				desc = ""
				picture = "gfx/leaders/HSF/zhensui.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_zhensui = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_gunther_von_kluge
			GER_gunther_von_kluge = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "君特·冯·克鲁格"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_gunther_von_kluge.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_gunther_von_kluge = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_martin_bormann
			GER_martin_bormann = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "马丁·鲍曼"
				desc = ""
				picture = "gfx/leaders/GER/Hasso von Manteuffel.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_martin_bormann = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_erwin_rommel
			GER_erwin_rommel = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "埃尔温·隆美尔"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_erwin_rommel.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_erwin_rommel = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_erich_von_manstein
			GER_erich_von_manstein = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "埃里希·冯·曼施坦因"
				desc = ""
				picture = "gfx/leaders/GER/Portrait_Germany_erich_von_manstein.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_erich_von_manstein = {
			set_character_flag = has_been_a_governor
		}
	}
	else_if = {
		limit = {
			has_character = GER_speer
			GER_speer = {
				not = {
					has_character_flag = has_been_a_governor
				}
				is_country_leader = no
			}
		}
		PREV = {
			create_country_leader = {
				name = "阿尔伯特·施佩尔"
				desc = ""
				picture = "gfx/leaders/GER/speer.dds"
				expire = "1985.1.1"
				ideology = nazism
				traits = {
				}
			}
		}
		GER_speer = {
			set_character_flag = has_been_a_governor
		}
	}
}
