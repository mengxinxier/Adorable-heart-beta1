JAP_interservice_rivalry_towards_army = {
	
	if = {
		limit = {  has_idea = JAP_interservice_rivalry_army_strengthened }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_army_strengthened
			add_idea = JAP_interservice_rivalry_army_dominant
		}
	}

	if = {
		limit = { has_idea = JAP_interservice_rivalry_balanced }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_balanced
			add_idea = JAP_interservice_rivalry_army_strengthened
		}
	}

	if = {
		limit = { has_idea = JAP_interservice_rivalry_navy_strengthened }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_navy_strengthened
			add_idea = JAP_interservice_rivalry_balanced
		}
	}

	if = {
		limit = { has_idea = JAP_interservice_rivalry_navy_dominant }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_navy_dominant
			add_idea = JAP_interservice_rivalry_navy_strengthened
		}
	}

}

JAP_interservice_rivalry_towards_navy = {

	if = {
		limit = { has_idea = JAP_interservice_rivalry_navy_strengthened }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_navy_strengthened
			add_idea = JAP_interservice_rivalry_navy_dominant
		}
	}	
	if = {
		limit = { has_idea = JAP_interservice_rivalry_balanced }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_balanced
			add_idea = JAP_interservice_rivalry_navy_strengthened
		}
	}
	if = {
		limit = { has_idea = JAP_interservice_rivalry_army_strengthened }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_army_strengthened
			add_idea = JAP_interservice_rivalry_balanced
		}
	}
	if = {
		limit = { has_idea = JAP_interservice_rivalry_army_dominant }
		swap_ideas = {
			remove_idea = JAP_interservice_rivalry_army_dominant
			add_idea = JAP_interservice_rivalry_army_strengthened
		}
	}
	
	
	
}


JAP_daxiaotaio_dengji = {
	if = {
		limit = { has_idea = JAP_daxiaotiao }
		swap_ideas = {
			remove_idea = JAP_daxiaotiao
			add_idea = JAP_daxiaotiao_2
		}
	}
	else_if = {
		limit = { has_idea = JAP_daxiaotiao_2 }
		swap_ideas = {
			remove_idea = JAP_daxiaotiao_2
			add_idea = JAP_daxiaotiao_3
		}
	}
	else_if = {
		limit = { has_idea = JAP_daxiaotiao_3 }
		swap_ideas = {
			remove_idea = JAP_daxiaotiao_3
			add_idea = JAP_daxiaotiao_4
		}
	}
	else_if = {
		limit = { has_idea = JAP_daxiaotiao_4 }
		swap_ideas = {
			remove_idea = JAP_daxiaotiao_4
			add_idea = JAP_daxiaotiao_5
		}
	}
}

#落日
JAP_fading_sun = {
	hidden_effect = {
		if = {
			limit = {
				NOT = { has_global_flag = JAP_Fading_Sun }
			}
			set_global_flag = JAP_Fading_Sun
			set_global_flag = JAP_fading_sun_fired
			JAP = {
				#清除了残余战争借口
				every_enemy_country = {
					JAP = {
						remove_wargoal = {
							type = all
							target = PREV
						}
					}
				}
				#附庸国独立
				if = {
					limit = { exists = yes }
					every_country = {
						limit = {
							OR = {
								is_guaranteed_by = PREV
								is_subject_of = PREV
								has_non_aggression_pact_with = PREV
								has_military_access_to = PREV
								gives_military_access_to = PREV
							}
						}
						diplomatic_relation = {
							country = JAP
							relation = military_access
							active = no
						}
						JAP = {
							if = {
								limit = { has_subject = PREV }
								set_autonomy = {
									target = PREV
									autonomy_state = autonomy_free
								}
							}
							diplomatic_relation = {
								country = PREV
								relation = guarantee
								active = no
							}
							diplomatic_relation = {
								country = PREV
								relation = non_aggression_pact
								active = no
							}
							diplomatic_relation = {
								country = PREV
								relation = military_access
								active = no
							}
						}
					}
				}
			}
			#清除本土外的核心与宣称
			every_state = {
				limit = {
					NOT = {
						region = 154 #Home Islands
						state = 526 #Okinawa
						state = 537 #Sakhalin
						state = 555 #Kurils
						state = 645 #Iwo Jima
						state = 648 #Marcus Island
					}
				}
				remove_core_of = JAP
				remove_claim_by = JAP
			}
			#日本条约领
			create_dynamic_country = {
				original_tag = JAP
				copy_tag = JAP
				save_global_event_target_as = JAP_peace_conference_tag
				set_country_flag = { flag = disabled_annexations days = 15 value = 1 }
				set_politics = { ruling_party = neutrality }
				set_political_party = { ideology = neutrality popularity = 100 }
				ROOT = {
					every_enemy_country = {
						event_target:JAP_peace_conference_tag = {
							add_to_war = {
								targeted_alliance = ROOT
								enemy = PREV
							}
						}
					}
					every_owned_state = {
						limit = {
							NOT = {
								region = 154 #Home Islands
								state = 526 #Okinawa
								state = 555 #Kurils
							}
						}
						add_core_of = event_target:JAP_peace_conference_tag
						if = {
							limit = {
								OR = {
									is_fully_controlled_by = ROOT
									state = 745 #Kwantung
								}
							}
							event_target:JAP_peace_conference_tag = { transfer_state = PREV }
						}
						else = {
							event_target:JAP_peace_conference_tag = { set_state_owner = PREV }
						}
					}
				}
				add_timed_idea = {
					idea = ready_to_surrender
					days = 15
				}
				set_cosmetic_tag = JAP_treaty
			}
			#盟友-离开阵营
			every_other_country = {
				limit = { is_in_faction_with = JAP }
				if = {
					limit = {
						OR = {
							is_chinese_country = yes
							has_capitulated = yes
						}
					}
					leave_faction = yes
				}
				else = {
					set_country_flag = JAP_was_in_sphere
				}
			}
			###白和
			every_enemy_country = {
				limit = {
					is_valid_peace_target = yes
					NOT = { has_country_flag = JAP_no_peace }
				}
				if = {
					limit = {
						is_chinese_country = yes
					}
					white_peace = { 
						tag = ROOT
						message = JAP_beiluorili
					}
				}
				else = {
					white_peace = { 
						tag = ROOT
					}
				}
			}
			# #解散阵营
			# if = {
			# 	limit = { is_faction_leader = no }
			# 	set_faction_leader = yes
			# }
			# dismantle_faction = yes
		}
	}
}