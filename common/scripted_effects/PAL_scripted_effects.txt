PAL_remove_all_ideas = {
	hidden_effect = {
		remove_ideas = {
			PAL_theresia_idea
			PAL_Aefanyl_idea
			PAL_Nymph_idea
			PAL_Amiya_king_idea
		}
	}
}

###  缓解粮食短缺  ###
PAL_Alleviate_Food_shortages = {
	custom_effect_tooltip = PAL_Alleviate_Food_shortages_TT
	if = {
		limit = { has_idea = PAL_Food_shortages }
		swap_ideas = {
			remove_idea = PAL_Food_shortages
			add_idea = PAL_Food_shortages_1
		}
	}
	else_if = {
		limit = { has_idea = PAL_Food_shortages_1 }
		swap_ideas = {
			remove_idea = PAL_Food_shortages_1
			add_idea = PAL_Food_shortages_2
		}
	}
	else_if = {
		limit = { has_idea = PAL_Food_shortages_2 }
		remove_ideas = PAL_Food_shortages_2
	}
}

###  载入21点  ###
PAL_load_in_Blackjack = {
	clear_array = global.PAL_RIS_Blackjack_array
	add_to_array = { global.PAL_RIS_Blackjack_array = 1 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 1 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 2 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 2 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 3 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 3 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 4 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 4 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 5 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 5 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 6 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 6 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 7 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 7 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 8 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 8 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 9 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 9 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 10 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 10 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 1 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 1 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 2 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 2 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 3 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 3 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 4 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 4 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 5 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 5 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 6 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 6 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 7 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 7 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 8 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 8 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 9 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 9 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 10 }
	add_to_array = { global.PAL_RIS_Blackjack_array = 10 }
	set_variable = { PAL.RCIW_hands_total_point = 0 }
	set_variable = { RIS.RCIW_hands_total_point = 0 }
	clear_array = PAL.PAL_RIS_Blackjack_hands_array
	clear_array = RIS.PAL_RIS_Blackjack_hands_array
}

###  抽牌21点  ###
PAL_Gacha_Blackjack = {
	random_list = {
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 1
					}
				}
			}
			custom_effect_tooltip = 1
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 1 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 1 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 1 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 2
					}
				}
			}
			custom_effect_tooltip = 2
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 2 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 2 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 2 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 3
					}
				}
			}
			custom_effect_tooltip = 3
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 3 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 3 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 3 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 4
					}
				}
			}
			custom_effect_tooltip = 4
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 4 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 4 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 4 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 5
					}
				}
			}
			custom_effect_tooltip = 5
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 5 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 5 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 5 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 6
					}
				}
			}
			custom_effect_tooltip = 6
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 6 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 6 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 6 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 7
					}
				}
			}
			custom_effect_tooltip = 7
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 7 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 7 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 7 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 8
					}
				}
			}
			custom_effect_tooltip = 8
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 8 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 8 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 8 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 9
					}
				}
			}
			custom_effect_tooltip = 9
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 9 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 9 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 9 }
		}
		10 = {
			modifier = {
				factor = 0
				not = {
					is_in_array = {
						array = global.PAL_RIS_Blackjack_array
						value = 10
					}
				}
			}
			custom_effect_tooltip = 10
			add_to_array = { ROOT.PAL_RIS_Blackjack_hands_array = 10 }
			remove_from_array = { global.PAL_RIS_Blackjack_array = 10 }
			add_to_variable = { ROOT.RCIW_hands_total_point = 10 }
		}
	}
}

###  结算21点  ###
PAL_settle_Blackjack = {
	if = {
		limit = {
			PAL = { has_country_flag = ready_for_RCIW_settlement }
			RIS = { has_country_flag = ready_for_RCIW_settlement }
		}
		if = {  ##平
			limit = {
				check_variable = { PAL.RCIW_hands_total_point > 21 }
				check_variable = { RIS.RCIW_hands_total_point > 21 }
			}
			PAL = { country_event = { id = PAL.019 } }
			RIS = { country_event = { id = PAL.019 } }
		}
		else_if = {  ##PAL胜
			limit = {
				check_variable = { PAL.RCIW_hands_total_point < 22 }
				or = {
					check_variable = { RIS.RCIW_hands_total_point > 21 }
					check_variable = { PAL.RCIW_hands_total_point > RIS.RCIW_hands_total_point }
				}
			}
			add_to_variable = { PAL.RCIW_point = 1 }
			PAL = { country_event = { id = PAL.018 } }
			RIS = { country_event = { id = PAL.020 } }
		}
		else_if = {  ##RIS胜
			limit = {
				check_variable = { RIS.RCIW_hands_total_point < 22 }
				or = {
					check_variable = { PAL.RCIW_hands_total_point > 21 }
					check_variable = { RIS.RCIW_hands_total_point > PAL.RCIW_hands_total_point }
				}
			}
			add_to_variable = { RIS.RCIW_point = 1 }
			PAL = { country_event = { id = PAL.021 } }
			RIS = { country_event = { id = PAL.018 } }
		}
		else = {
			PAL = { country_event = { id = PAL.019 } }
			RIS = { country_event = { id = PAL.019 } }
		}
		PAL = { clr_country_flag = ready_for_RCIW_settlement }
		RIS = { clr_country_flag = ready_for_RCIW_settlement }
	}
}
